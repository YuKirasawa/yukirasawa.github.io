<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yukirasawa.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="摸鱼的地方">
<meta property="og:type" content="website">
<meta property="og:title" content="吉良泽优的小站">
<meta property="og:url" content="https://yukirasawa.github.io/index.html">
<meta property="og:site_name" content="吉良泽优的小站">
<meta property="og:description" content="摸鱼的地方">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="吉良泽优">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://yukirasawa.github.io/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>吉良泽优的小站</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="吉良泽优的小站" type="application/atom+xml">
<link rel="alternate" href="/rss2.xml" title="吉良泽优的小站" type="application/rss+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">吉良泽优的小站</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于我</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://yukirasawa.github.io/2023/02/15/neovim-%E9%85%8D%E7%BD%AE%E8%BF%81%E7%A7%BB%E8%AE%B0%E5%BD%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="吉良泽优">
      <meta itemprop="description" content="摸鱼的地方">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="吉良泽优的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/02/15/neovim-%E9%85%8D%E7%BD%AE%E8%BF%81%E7%A7%BB%E8%AE%B0%E5%BD%95/" class="post-title-link" itemprop="url">neovim 配置迁移记录</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-02-15 19:11:32" itemprop="dateCreated datePublished" datetime="2023-02-15T19:11:32+08:00">2023-02-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-02-18 14:52:59" itemprop="dateModified" datetime="2023-02-18T14:52:59+08:00">2023-02-18</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>（上一次配 vim 还是上大学之前，转眼就快本科毕业了。）</p>
<p>这次主要是把一部分 <code>.vimrc</code> 中的配置迁移到 neovim 的 lua 风格配置上，同时把一部分插件迁移到 neovim 的生态中。</p>
<h2 id="基本配置"><a href="#基本配置" class="headerlink" title="基本配置"></a>基本配置</h2><p>配置主要存放在 <code>~/.config/nvim</code>，目录结构大致为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">├── init.lua</span><br><span class="line">└── lua</span><br><span class="line">    ├── core</span><br><span class="line">    └── plugins</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>其中 <code>core</code> 中存放全局配置，<code>plugins</code> 中存放插件相关配置，<code>init.lua</code> 中引用各个配置，因此后面每个文件配置时都需要在 <code>init.lua</code> 中 <code>require</code>。</p>
<p>为了配置迁移的平滑性，先在 <code>init.lua</code> 中加入下面的代码，使其读取原本的 <code>.vimrc</code> 文件</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vim.cmd <span class="string">[[</span></span><br><span class="line"><span class="string">set runtimepath^=~/.vim</span></span><br><span class="line"><span class="string">let &amp;packpath = &amp;runtimepath</span></span><br><span class="line"><span class="string">source ~/.vimrc</span></span><br><span class="line"><span class="string">]]</span></span><br></pre></td></tr></table></figure>

<p>在 <code>core</code> 文件夹中，创建 <code>options.lua</code> 用于配置 neovim 的选项，我的配置如下</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 基础配置</span></span><br><span class="line"><span class="keyword">local</span> opt = vim.opt</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 不创建交换文件</span></span><br><span class="line">opt.swapfile = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 搜索</span></span><br><span class="line">opt.ignorecase = <span class="literal">true</span></span><br><span class="line">opt.smartcase = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 真彩色</span></span><br><span class="line">opt.termguicolors = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 缩进</span></span><br><span class="line">opt.tabstop = <span class="number">4</span></span><br><span class="line">opt.shiftwidth = <span class="number">4</span></span><br><span class="line">opt.expandtab = <span class="literal">true</span></span><br><span class="line">opt.autoindent = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用鼠标</span></span><br><span class="line">opt.mouse:append(<span class="string">&quot;a&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使 gg 等命令把光标移动到行首的第一个非空白字符</span></span><br><span class="line">opt.startofline = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 关闭自动换行</span></span><br><span class="line">opt.<span class="built_in">wrap</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 突出当前行</span></span><br><span class="line">opt.cursorline = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 使用系统剪切板</span></span><br><span class="line">opt.clipboard:append(<span class="string">&quot;unnamedplus&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>在 <code>core</code> 文件夹中，创建 <code>keymaps.lua</code> 用于配置键位映射，我的配置如下</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 按键映射</span></span><br><span class="line"><span class="keyword">local</span> keymap = vim.keymap</span><br><span class="line"></span><br><span class="line">keymap.set(<span class="string">&quot;i&quot;</span>, <span class="string">&quot;jk&quot;</span>, <span class="string">&quot;&lt;ESC&gt;&quot;</span>, &#123;noremap = <span class="literal">true</span>, silent = <span class="literal">true</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 一键编译运行 (SingleCompile)</span></span><br><span class="line">keymap.set(<span class="string">&quot;n&quot;</span>, <span class="string">&quot;&lt;F9&gt;&quot;</span>, <span class="string">&quot;:SCCompile &lt;cr&gt;&quot;</span>)</span><br><span class="line">keymap.set(<span class="string">&quot;n&quot;</span>, <span class="string">&quot;&lt;F10&gt;&quot;</span>, <span class="string">&quot;:SCCompileRun &lt;cr&gt;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>上面这些基本是从 <code>.vimrc</code> 中直接翻译过来</p>
<h2 id="packer"><a href="#packer" class="headerlink" title="packer"></a>packer</h2><p>我原本使用 <code>plugged</code> 进行插件管理，这次将新的插件使用 <code>packer</code> 配置，之后会把 <code>plugged</code> 中的插件逐步替换和迁移过来。</p>
<p>在 <code>plugins</code> 文件夹中创建 <code>packer-setup.lua</code> 用于 <code>packer</code> 的自动安装。我这里使用的安装目录是 <code>~/.local/share/nvim/site/pack/packer</code>，后面通过 <code>packer</code> 安装的插件也会存放在这个目录。</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> packer_setup = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 检查和安装 packer</span></span><br><span class="line">packer_setup.ensure_packer = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">  <span class="keyword">local</span> fn = vim.fn</span><br><span class="line">  <span class="keyword">local</span> install_path = fn.stdpath(<span class="string">&#x27;data&#x27;</span>)..<span class="string">&#x27;/site/pack/packer/start/packer.nvim&#x27;</span></span><br><span class="line">  <span class="keyword">if</span> fn.empty(fn.glob(install_path)) &gt; <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">    fn.system(&#123;<span class="string">&#x27;git&#x27;</span>, <span class="string">&#x27;clone&#x27;</span>, <span class="string">&#x27;--depth&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;https://github.com/wbthomason/packer.nvim&#x27;</span>, install_path&#125;)</span><br><span class="line">    vim.cmd <span class="string">[[packadd packer.nvim]]</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> packer_setup</span><br></pre></td></tr></table></figure>

<p>在 <code>plugins</code> 文件夹中创建 <code>packer.lua</code> 用于 <code>packer</code> 的插件管理。安装插件只需要在这里添加 <code>use</code> 语句。</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 保存本文件时自动更新插件</span></span><br><span class="line">vim.cmd(<span class="string">[[</span></span><br><span class="line"><span class="string">  augroup packer_user_config</span></span><br><span class="line"><span class="string">    autocmd!</span></span><br><span class="line"><span class="string">    autocmd BufWritePost packer.lua source &lt;afile&gt; | PackerSync</span></span><br><span class="line"><span class="string">  augroup end</span></span><br><span class="line"><span class="string">]]</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> packer_bootstrap = <span class="built_in">require</span>(<span class="string">&quot;plugins.packer-setup&quot;</span>).ensure_packer()</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="built_in">require</span>(<span class="string">&#x27;packer&#x27;</span>).startup(<span class="function"><span class="keyword">function</span><span class="params">(use)</span></span></span><br><span class="line">  use <span class="string">&#x27;wbthomason/packer.nvim&#x27;</span></span><br><span class="line">  <span class="comment">-- My plugins here</span></span><br><span class="line">  use <span class="string">&#x27;neovim/nvim-lspconfig&#x27;</span> <span class="comment">-- Configurations for Nvim LSP</span></span><br><span class="line">  use <span class="string">&#x27;hrsh7th/nvim-cmp&#x27;</span> <span class="comment">-- Autocompletion plugin</span></span><br><span class="line">  </span><br><span class="line">  use <span class="string">&#x27;hrsh7th/cmp-nvim-lsp&#x27;</span> <span class="comment">-- LSP source for nvim-cmp</span></span><br><span class="line">  use <span class="string">&#x27;hrsh7th/cmp-nvim-lsp-signature-help&#x27;</span> <span class="comment">-- nvim-cmp source for displaying function signatures</span></span><br><span class="line">  </span><br><span class="line">  use <span class="string">&#x27;hrsh7th/cmp-path&#x27;</span> <span class="comment">-- path source for nvim-cmp</span></span><br><span class="line">  use <span class="string">&#x27;hrsh7th/cmp-buffer&#x27;</span> <span class="comment">-- buffer source for nvim-cmp</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">-- LuaSnip, not used now</span></span><br><span class="line">  use(&#123;<span class="string">&quot;L3MON4D3/LuaSnip&quot;</span>, run = <span class="string">&quot;make install_jsregexp&quot;</span>&#125;)</span><br><span class="line">  use <span class="string">&#x27;saadparwaiz1/cmp_luasnip&#x27;</span> <span class="comment">-- LuaSnip source for nvim-cmp</span></span><br><span class="line">  </span><br><span class="line">  use <span class="string">&#x27;sirver/ultisnips&#x27;</span></span><br><span class="line">  use <span class="string">&#x27;honza/vim-snippets&#x27;</span> <span class="comment">-- snippets collection for ultisnips</span></span><br><span class="line">  use <span class="string">&#x27;quangnguyen30192/cmp-nvim-ultisnips&#x27;</span> <span class="comment">-- ultisnips source for nvim-cmp</span></span><br><span class="line"></span><br><span class="line">  use &#123;<span class="string">&#x27;iamcco/markdown-preview.nvim&#x27;</span>, run = <span class="string">&#x27;cd app &amp;&amp; yarn install&#x27;</span>, cmd = <span class="string">&#x27;MarkdownPreview&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">-- File Explorer</span></span><br><span class="line">  use &#123;</span><br><span class="line">    <span class="string">&#x27;nvim-tree/nvim-tree.lua&#x27;</span>,</span><br><span class="line">    requires = &#123;</span><br><span class="line">      <span class="string">&#x27;nvim-tree/nvim-web-devicons&#x27;</span>, <span class="comment">-- for file icons</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">-- treesitter and its module</span></span><br><span class="line">  use &#123;</span><br><span class="line">    <span class="string">&#x27;nvim-treesitter/nvim-treesitter&#x27;</span>,</span><br><span class="line">    run = <span class="string">&#x27;:TSUpdate&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">  use <span class="string">&#x27;p00f/nvim-ts-rainbow&#x27;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">-- statusline</span></span><br><span class="line">  use &#123;</span><br><span class="line">    <span class="string">&#x27;nvim-lualine/lualine.nvim&#x27;</span>,</span><br><span class="line">    requires = &#123; <span class="string">&#x27;kyazdani42/nvim-web-devicons&#x27;</span>, opt = <span class="literal">true</span> &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">-- colorsheme</span></span><br><span class="line">  use <span class="string">&#x27;rebelot/kanagawa.nvim&#x27;</span></span><br><span class="line">  use &#123; <span class="string">&#x27;embark-theme/vim&#x27;</span>, as = <span class="string">&#x27;embark&#x27;</span> &#125;</span><br><span class="line">  <span class="comment">-- Automatically set up your configuration after cloning packer.nvim</span></span><br><span class="line">  <span class="comment">-- Put this at the end after all plugins</span></span><br><span class="line">  <span class="keyword">if</span> packer_bootstrap <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">require</span>(<span class="string">&#x27;packer&#x27;</span>).sync()</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span>)</span><br></pre></td></tr></table></figure>

<h2 id="LSP-和补全"><a href="#LSP-和补全" class="headerlink" title="LSP 和补全"></a>LSP 和补全</h2><p>neovim 的主要特性之一就是添加了对 Language Server Protocol 的原生支持，我也把原本基于 YouCompleteMe 的补全迁移到 Nvim LSP client 上。用到的插件主要有 <code>nvim-lspconfig</code>、<code>nvim-cmp</code>、<code>cmp-nvim-lsp</code>，还有一些其他的插件提供辅助功能，具体可以看上面的插件列表。我尝试了 <code>LuaSnip</code>，但是感觉不如一直使用的 <code>ultisnips</code> 顺手，所以目前继续使用 <code>ultisnips</code>。LSP 协议支持自定义 style 的 formatting，但 clangd 对这个特性的支持并不好（来源: <a target="_blank" rel="noopener" href="https://clangd.llvm.org/features#formatting%EF%BC%89%EF%BC%8C%E5%9B%A0%E6%AD%A4%E6%88%91%E4%BF%9D%E7%95%99%E4%BA%86%E5%8E%9F%E6%9C%AC%E4%BD%BF%E7%94%A8%E7%9A%84">https://clangd.llvm.org/features#formatting），因此我保留了原本使用的</a> vim-autoformat 插件用于 formatting。</p>
<p>主要的配置文件就是配置 LSP 的 <code>lspconfig.lua</code> 和配置补全的 <code>nvim-cmp.lua</code>，其中 LSP 的键位基本是默认的，补全则根据以前使用的键位做了一些配置</p>
<p><code>lspconfig.lua</code></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Mappings.</span></span><br><span class="line"><span class="comment">-- See `:help vim.diagnostic.*` for documentation on any of the below functions</span></span><br><span class="line"><span class="keyword">local</span> opts = &#123; noremap=<span class="literal">true</span>, silent=<span class="literal">true</span> &#125;</span><br><span class="line">vim.keymap.set(<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;&lt;space&gt;e&#x27;</span>, vim.diagnostic.open_float, opts)</span><br><span class="line">vim.keymap.set(<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;[d&#x27;</span>, vim.diagnostic.goto_prev, opts)</span><br><span class="line">vim.keymap.set(<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;]d&#x27;</span>, vim.diagnostic.goto_next, opts)</span><br><span class="line">vim.keymap.set(<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;&lt;space&gt;q&#x27;</span>, vim.diagnostic.setloclist, opts)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Use an on_attach function to only map the following keys</span></span><br><span class="line"><span class="comment">-- after the language server attaches to the current buffer</span></span><br><span class="line"><span class="keyword">local</span> on_attach = <span class="function"><span class="keyword">function</span><span class="params">(client, bufnr)</span></span></span><br><span class="line">  <span class="comment">-- Enable completion triggered by &lt;c-x&gt;&lt;c-o&gt;</span></span><br><span class="line">  vim.api.nvim_buf_set_option(bufnr, <span class="string">&#x27;omnifunc&#x27;</span>, <span class="string">&#x27;v:lua.vim.lsp.omnifunc&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">-- Mappings.</span></span><br><span class="line">  <span class="comment">-- See `:help vim.lsp.*` for documentation on any of the below functions</span></span><br><span class="line">  <span class="keyword">local</span> bufopts = &#123; noremap=<span class="literal">true</span>, silent=<span class="literal">true</span>, buffer=bufnr &#125;</span><br><span class="line">  vim.keymap.set(<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;gD&#x27;</span>, vim.lsp.buf.declaration, bufopts)</span><br><span class="line">  vim.keymap.set(<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;gd&#x27;</span>, vim.lsp.buf.definition, bufopts)</span><br><span class="line">  vim.keymap.set(<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;K&#x27;</span>, vim.lsp.buf.hover, bufopts)</span><br><span class="line">  vim.keymap.set(<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;gi&#x27;</span>, vim.lsp.buf.implementation, bufopts)</span><br><span class="line">  vim.keymap.set(<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;&lt;C-k&gt;&#x27;</span>, vim.lsp.buf.signature_help, bufopts)</span><br><span class="line">  vim.keymap.set(<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;&lt;space&gt;wa&#x27;</span>, vim.lsp.buf.add_workspace_folder, bufopts)</span><br><span class="line">  vim.keymap.set(<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;&lt;space&gt;wr&#x27;</span>, vim.lsp.buf.remove_workspace_folder, bufopts)</span><br><span class="line">  vim.keymap.set(<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;&lt;space&gt;wl&#x27;</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">print</span>(vim.inspect(vim.lsp.buf.list_workspace_folders()))</span><br><span class="line">  <span class="keyword">end</span>, bufopts)</span><br><span class="line">  vim.keymap.set(<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;&lt;space&gt;D&#x27;</span>, vim.lsp.buf.type_definition, bufopts)</span><br><span class="line">  vim.keymap.set(<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;&lt;space&gt;rn&#x27;</span>, vim.lsp.buf.<span class="built_in">rename</span>, bufopts)</span><br><span class="line">  vim.keymap.set(<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;&lt;space&gt;ca&#x27;</span>, vim.lsp.buf.code_action, bufopts)</span><br><span class="line">  vim.keymap.set(<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;gr&#x27;</span>, vim.lsp.buf.references, bufopts)</span><br><span class="line">  vim.keymap.set(<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;&lt;space&gt;f&#x27;</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span></span> vim.lsp.buf.<span class="built_in">format</span> &#123; async = <span class="literal">true</span> &#125; <span class="keyword">end</span>, bufopts)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> lsp_flags = &#123;</span><br><span class="line">  <span class="comment">-- This is the default in Nvim 0.7+</span></span><br><span class="line">  debounce_text_changes = <span class="number">150</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Add additional capabilities supported by nvim-cmp</span></span><br><span class="line"><span class="keyword">local</span> capabilities = <span class="built_in">require</span>(<span class="string">&quot;cmp_nvim_lsp&quot;</span>).default_capabilities()</span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> lspconfig = <span class="built_in">require</span>(<span class="string">&#x27;lspconfig&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Enable some language servers with the additional completion capabilities offered by nvim-cmp</span></span><br><span class="line"><span class="keyword">local</span> servers = &#123; <span class="string">&#x27;clangd&#x27;</span>, <span class="string">&#x27;rust_analyzer&#x27;</span>, <span class="string">&#x27;pyright&#x27;</span>, <span class="string">&#x27;tsserver&#x27;</span> &#125;</span><br><span class="line"><span class="keyword">for</span> _, lsp <span class="keyword">in</span> <span class="built_in">ipairs</span>(servers) <span class="keyword">do</span></span><br><span class="line">  lspconfig[lsp].setup &#123;</span><br><span class="line">    on_attach = on_attach,</span><br><span class="line">    flags = lsp_flags,</span><br><span class="line">    capabilities = capabilities,</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p><code>nvim-cmp.lua</code></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ultisnips setup</span></span><br><span class="line"><span class="keyword">local</span> cmp_ultisnips_mappings = <span class="built_in">require</span>(<span class="string">&quot;cmp_nvim_ultisnips.mappings&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- nvim-cmp setup</span></span><br><span class="line"><span class="keyword">local</span> cmp = <span class="built_in">require</span> <span class="string">&#x27;cmp&#x27;</span></span><br><span class="line">cmp.setup &#123;</span><br><span class="line">  snippet = &#123;</span><br><span class="line">    expand = <span class="function"><span class="keyword">function</span><span class="params">(args)</span></span></span><br><span class="line">      <span class="comment">-- luasnip.lsp_expand(args.body)</span></span><br><span class="line">      vim.fn[<span class="string">&quot;UltiSnips#Anon&quot;</span>](args.body)</span><br><span class="line">    <span class="keyword">end</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  mapping = cmp.mapping.preset.<span class="built_in">insert</span>(&#123;</span><br><span class="line">    <span class="comment">-- 上一个</span></span><br><span class="line">    [<span class="string">&#x27;&lt;C-k&gt;&#x27;</span>] = cmp.mapping(<span class="function"><span class="keyword">function</span><span class="params">(fallback)</span></span></span><br><span class="line">      <span class="keyword">if</span> cmp.visible() <span class="keyword">then</span></span><br><span class="line">        cmp.select_prev_item()</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        cmp_ultisnips_mappings.jump_backwards(fallback)</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span>, &#123; <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;s&#x27;</span> &#125;),</span><br><span class="line">    [<span class="string">&#x27;&lt;Up&gt;&#x27;</span>] = cmp.mapping.select_prev_item(),</span><br><span class="line">    <span class="comment">-- 下一个</span></span><br><span class="line">    [<span class="string">&#x27;&lt;C-j&gt;&#x27;</span>] = cmp.mapping.select_next_item(),</span><br><span class="line">    [<span class="string">&#x27;&lt;Down&gt;&#x27;</span>] = cmp.mapping.select_next_item(),</span><br><span class="line"> </span><br><span class="line">    [<span class="string">&#x27;&lt;C-u&gt;&#x27;</span>] = cmp.mapping.scroll_docs(<span class="number">-4</span>), <span class="comment">-- Up</span></span><br><span class="line">    [<span class="string">&#x27;&lt;C-d&gt;&#x27;</span>] = cmp.mapping.scroll_docs(<span class="number">4</span>), <span class="comment">-- Down</span></span><br><span class="line"></span><br><span class="line">    [<span class="string">&#x27;&lt;C-z&gt;&#x27;</span>] = cmp.mapping.complete(), <span class="comment">-- 打开补全列表</span></span><br><span class="line">    [<span class="string">&#x27;&lt;CR&gt;&#x27;</span>] = cmp.mapping.confirm &#123;</span><br><span class="line">      behavior = cmp.ConfirmBehavior.Replace,</span><br><span class="line">      <span class="built_in">select</span> = <span class="literal">false</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    [<span class="string">&#x27;&lt;C-a&gt;&#x27;</span>] = cmp.mapping(<span class="function"><span class="keyword">function</span><span class="params">(fallback)</span></span></span><br><span class="line">      cmp_ultisnips_mappings.expand_or_jump_forwards(fallback)</span><br><span class="line">    <span class="keyword">end</span>, &#123; <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;s&#x27;</span> &#125;),</span><br><span class="line">    [<span class="string">&#x27;&lt;Tab&gt;&#x27;</span>] = cmp.mapping(<span class="function"><span class="keyword">function</span><span class="params">(fallback)</span></span></span><br><span class="line">      <span class="keyword">if</span> cmp.visible() <span class="keyword">then</span></span><br><span class="line">        cmp.select_next_item()</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        cmp_ultisnips_mappings.expand_or_jump_forwards(fallback)</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span>, &#123; <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;s&#x27;</span> &#125;),</span><br><span class="line">    [<span class="string">&#x27;&lt;S-Tab&gt;&#x27;</span>] = cmp.mapping(<span class="function"><span class="keyword">function</span><span class="params">(fallback)</span></span></span><br><span class="line">      <span class="keyword">if</span> cmp.visible() <span class="keyword">then</span></span><br><span class="line">        cmp.select_prev_item()</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        cmp_ultisnips_mappings.jump_backwards(fallback)</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span>, &#123; <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;s&#x27;</span> &#125;),</span><br><span class="line">  &#125;),</span><br><span class="line">  sources = &#123;</span><br><span class="line">    &#123; name = <span class="string">&#x27;nvim_lsp&#x27;</span> &#125;,</span><br><span class="line">    &#123; name = <span class="string">&#x27;nvim_lsp_signature_help&#x27;</span> &#125;,</span><br><span class="line">    &#123; name = <span class="string">&#x27;ultisnips&#x27;</span> &#125;, </span><br><span class="line">    &#123; name = <span class="string">&#x27;path&#x27;</span> &#125;,</span><br><span class="line">    &#123; name = <span class="string">&#x27;buffer&#x27;</span> &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="nvim-tree"><a href="#nvim-tree" class="headerlink" title="nvim-tree"></a>nvim-tree</h2><p>添加了在打开目录时调用 <code>nvim-tree</code> 的 autocmd</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- disable netrw</span></span><br><span class="line">vim.g.loaded_netrw = <span class="number">1</span></span><br><span class="line">vim.g.loaded_netrwPlugin = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">require</span>(<span class="string">&quot;nvim-tree&quot;</span>).setup(&#123;</span><br><span class="line">  sort_by = <span class="string">&quot;case_sensitive&quot;</span>,</span><br><span class="line">    </span><br><span class="line">  view = &#123;</span><br><span class="line">    width = <span class="number">30</span>,</span><br><span class="line">    mappings = &#123;</span><br><span class="line">      list = &#123;</span><br><span class="line">        &#123; key = <span class="string">&quot;u&quot;</span>, action = <span class="string">&quot;dir_up&quot;</span> &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  renderer = &#123;</span><br><span class="line">    group_empty = <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  filters = &#123;</span><br><span class="line">    dotfiles = <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- open tree when open or change to directory</span></span><br><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">open_nvim_tree</span><span class="params">(data)</span></span></span><br><span class="line">  <span class="comment">-- buffer is a directory</span></span><br><span class="line">  <span class="keyword">local</span> directory = vim.fn.isdirectory(data.file) == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">not</span> directory <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">-- change to the directory</span></span><br><span class="line">  vim.cmd.cd(data.file)</span><br><span class="line"></span><br><span class="line">  <span class="comment">-- open the tree</span></span><br><span class="line">  <span class="built_in">require</span>(<span class="string">&quot;nvim-tree.api&quot;</span>).tree.<span class="built_in">open</span>()</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">vim.api.nvim_create_autocmd(&#123; <span class="string">&quot;VimEnter&quot;</span> &#125;, &#123; callback = open_nvim_tree &#125;)</span><br></pre></td></tr></table></figure>

<h2 id="nvim-treesitter"><a href="#nvim-treesitter" class="headerlink" title="nvim-treesitter"></a>nvim-treesitter</h2><p>配置了高亮、折叠和彩虹括号（需要 <code>p00f/nvim-ts-rainbow</code>）</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span><span class="string">&#x27;nvim-treesitter.configs&#x27;</span>.setup &#123;</span><br><span class="line">  <span class="comment">-- A list of parser names, or &quot;all&quot; (the four listed parsers should always be installed)</span></span><br><span class="line">  ensure_installed = &#123; <span class="string">&quot;c&quot;</span>, <span class="string">&quot;lua&quot;</span>, <span class="string">&quot;vim&quot;</span>, <span class="string">&quot;help&quot;</span>, <span class="string">&quot;cpp&quot;</span>, <span class="string">&quot;python&quot;</span> &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">-- Install parsers synchronously (only applied to `ensure_installed`)</span></span><br><span class="line">  sync_install = <span class="literal">false</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">-- Automatically install missing parsers when entering buffer</span></span><br><span class="line">  <span class="comment">-- Recommendation: set to false if you don&#x27;t have `tree-sitter` CLI installed locally</span></span><br><span class="line">  auto_install = <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">  highlight = &#123;</span><br><span class="line">    enable = <span class="literal">true</span>,</span><br><span class="line">    </span><br><span class="line">    <span class="comment">-- <span class="doctag">NOTE:</span> these are the names of the parsers and not the filetype. (for example if you want to</span></span><br><span class="line">    <span class="comment">-- disable highlighting for the `tex` filetype, you need to include `latex` in this list as this is</span></span><br><span class="line">    <span class="comment">-- the name of the parser)</span></span><br><span class="line">    <span class="comment">-- list of language that will be disabled</span></span><br><span class="line">    <span class="comment">-- disable = &#123; &quot;c&quot;, &quot;rust&quot; &#125;,</span></span><br><span class="line">    <span class="comment">-- Or use a function for more flexibility, e.g. to disable slow treesitter highlight for large files</span></span><br><span class="line">    disable = <span class="function"><span class="keyword">function</span><span class="params">(lang, buf)</span></span></span><br><span class="line">        <span class="keyword">local</span> max_filesize = <span class="number">100</span> * <span class="number">1024</span> <span class="comment">-- 100 KB</span></span><br><span class="line">        <span class="keyword">local</span> ok, stats = <span class="built_in">pcall</span>(vim.loop.fs_stat, vim.api.nvim_buf_get_name(buf))</span><br><span class="line">        <span class="keyword">if</span> ok <span class="keyword">and</span> stats <span class="keyword">and</span> stats.size &gt; max_filesize <span class="keyword">then</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Setting this to true will run `:h syntax` and tree-sitter at the same time.</span></span><br><span class="line">    <span class="comment">-- Set this to `true` if you depend on &#x27;syntax&#x27; being enabled (like for indentation).</span></span><br><span class="line">    <span class="comment">-- Using this option may slow down your editor, and you may see some duplicate highlights.</span></span><br><span class="line">    <span class="comment">-- Instead of true it can also be a list of languages</span></span><br><span class="line">    additional_vim_regex_highlighting = <span class="literal">false</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  rainbow = &#123;</span><br><span class="line">    enable = <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">-- disable = &#123; &quot;jsx&quot;, &quot;cpp&quot; &#125;, list of languages you want to disable the plugin for</span></span><br><span class="line">    extended_mode = <span class="literal">true</span>, <span class="comment">-- Also highlight non-bracket delimiters like html tags, boolean or table: lang -&gt; boolean</span></span><br><span class="line">    max_file_lines = <span class="literal">nil</span>, <span class="comment">-- Do not enable for files with more than n lines, int</span></span><br><span class="line">    <span class="comment">-- colors = &#123;&#125;, -- table of hex strings</span></span><br><span class="line">    <span class="comment">-- termcolors = &#123;&#125; -- table of colour name strings</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- vim.api.nvim_set_hl(0, &quot;@punctuation.bracket&quot;, &#123; link = &quot;&quot; &#125;)</span></span><br><span class="line">vim.cmd<span class="string">[[</span></span><br><span class="line"><span class="string">set foldmethod=expr</span></span><br><span class="line"><span class="string">set foldexpr=nvim_treesitter#foldexpr()</span></span><br><span class="line"><span class="string">set nofoldenable</span></span><br><span class="line"><span class="string">]]</span></span><br></pre></td></tr></table></figure>

<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>使用了状态栏 <code>nvim-lualine/lualine.nvim</code> 和配色 <code>rebelot/kanagawa.nvim</code>，我使用了一个 <code>appearance.lua</code> 文件管理这两个插件的配置</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 配色</span></span><br><span class="line">vim.cmd(<span class="string">&#x27;colorscheme kanagawa&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 状态栏</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;lualine&#x27;</span>).setup()</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://yukirasawa.github.io/2023/02/06/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="吉良泽优">
      <meta itemprop="description" content="摸鱼的地方">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="吉良泽优的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/02/06/hello-world/" class="post-title-link" itemprop="url">Hello World</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-02-06 16:18:42" itemprop="dateCreated datePublished" datetime="2023-02-06T16:18:42+08:00">2023-02-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-02-09 09:17:58" itemprop="dateModified" datetime="2023-02-09T09:17:58+08:00">2023-02-09</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Hello World</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="吉良泽优"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">吉良泽优</p>
  <div class="site-description" itemprop="description">摸鱼的地方</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">2</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">吉良泽优</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
